<div class="container profile-container mt-5 mb-5">
  <div class="row profile-card shadow-lg rounded overflow-hidden">
    <!-- Left Column -->
    <div class="col-md-4 profile-left text-white">
      <div
        *ngIf="user"
        class="d-flex flex-column align-items-center justify-content-center py-4"
      >
        <div class="profile-icon-wrapper mb-3">
          <i class="fas fa-user profile-icon"></i>
        </div>
        <h3 class="username mb-0">{{ user.userName | titlecase }}</h3>
        <p class="tagline">({{ user.email }})</p>
        <p class="tagline">Premium Member</p>
      </div>
    </div>

    <!-- Right Column -->
    <div class="col-md-8 profile-right p-4">
      <h4 class="mb-4">Profile Information</h4>
      <form #userForm="ngForm" (ngSubmit)="newUserName(userForm)">
        <div class="form-group mb-3 position-relative">
          <label>User Name</label>
          <input
            type="text"
            class="form-control"
            name="userName"
            [(ngModel)]="user.userName"
            [readonly]="!editingUser"
          />
          <div class="edit-icon">
            <button
              *ngIf="!editingUser"
              type="button"
              class="border-0 bg-transparent text-primary"
              (click)="editingUser = true"
            >
              &#9998;
            </button>
            <div *ngIf="editingUser">
              <button
                type="button"
                class="border-0 bg-transparent text-danger"
                (click)="editingUser = false"
              >
                ✕
              </button>
              <button
                type="submit"
                class="border-0 bg-transparent text-primary"
              >
                ✓
              </button>
            </div>
          </div>
        </div>
      </form>

      <div *ngIf="userAddress" class="col-md-8 profile-right p-4">
        <h4 class="mb-4">Address</h4>
        <form #form="ngForm" (ngSubmit)="updateAddress(form)">
          <div class="form-group mb-3">
            <label>Phone</label>
            <input
              type="tel"
              class="form-control"
              name="phone"
              [(ngModel)]="userAddress.phone"
              [readonly]="!editingAddress"
              required
            />
          </div>
          <div class="form-group mb-3">
            <label>State</label>
            <select
              class="form-control"
              name="state"
              [(ngModel)]="userAddress.state"
              [disabled]="!editingAddress"
              required
            >
              <option value="" selected>Select State</option>
              <option value="Andhra Pradesh">Andhra Pradesh</option>
              <option value="Arunachal Pradesh">Arunachal Pradesh</option>
              <option value="Assam">Assam</option>
              <option value="Bihar">Bihar</option>
              <option value="Chhattisgarh">Chhattisgarh</option>
              <option value="Goa">Goa</option>
              <option value="Gujarat">Gujarat</option>
              <option value="Haryana">Haryana</option>
              <option value="Himachal Pradesh">Himachal Pradesh</option>
              <option value="Jharkhand">Jharkhand</option>
              <option value="Karnataka">Karnataka</option>
              <option value="Kerala">Kerala</option>
              <option value="Madhya Pradesh">Madhya Pradesh</option>
              <option value="Maharashtra">Maharashtra</option>
              <option value="Manipur">Manipur</option>
              <option value="Meghalaya">Meghalaya</option>
              <option value="Mizoram">Mizoram</option>
              <option value="Nagaland">Nagaland</option>
              <option value="Odisha">Odisha</option>
              <option value="Punjab">Punjab</option>
              <option value="Rajasthan">Rajasthan</option>
              <option value="Sikkim">Sikkim</option>
              <option value="Tamil Nadu">Tamil Nadu</option>
              <option value="Telangana">Telangana</option>
              <option value="Tripura">Tripura</option>
              <option value="Uttar Pradesh">Uttar Pradesh</option>
              <option value="Uttarakhand">Uttarakhand</option>
              <option value="West Bengal">West Bengal</option>
              <option value="Chandigarh">Chandigarh</option>
              <option value="Delhi">Delhi</option>
              <option value="Jammu and Kashmir">Jammu and Kashmir</option>
              <option value="Ladakh">Ladakh</option>
              <option value="Lakshadweep">Lakshadweep</option>
              <option value="Puducherry">Puducherry</option>
            </select>
          </div>
          <div class="form-group mb-3">
            <label>District</label>
            <input
              type="text"
              class="form-control"
              name="district"
              [(ngModel)]="userAddress.district"
              [readonly]="!editingAddress"
              required
            />
          </div>
          <div class="form-group mb-3">
            <label>City</label>
            <input
              type="text"
              class="form-control"
              name="city"
              [(ngModel)]="userAddress.city"
              [readonly]="!editingAddress"
              required
            />
          </div>
          <div class="form-group mb-3">
            <label>PinCode</label>
            <input
              type="text"
              class="form-control"
              name="pinCode"
              [(ngModel)]="userAddress.pinCode"
              [readonly]="!editingAddress"
              required
            />
          </div>
          <div class="form-group mb-3">
            <label>Location</label>
            <textarea
              class="form-control"
              rows="3"
              name="addressLine"
              [(ngModel)]="userAddress.addressLine"
              [readonly]="!editingAddress"
              required
            >
            </textarea>
          </div>
          <button
            *ngIf="!editingAddress"
            type="button"
            class="btn btn-outline-primary me-2"
            (click)="editingAddress = !editingAddress"
          >
            Edit Address&#9998;
          </button>
          <div *ngIf="editingAddress">
            <button type="submit" class="btn btn-primary me-3">Save</button>
            <button
              type="button"
              class="btn btn-secondary"
              (click)="editingAddress = false"
            >
              Cancel
            </button>
          </div>
        </form>

        <!-- Action Cards -->
        <div class="row mt-5 g-3">
          <div class="col-6">
            <div class="action-card" (click)="goToOrders()">
              <i class="fas fa-box"></i>
              <span>My Orders</span>
            </div>
          </div>
          <div class="col-6">
            <div class="action-card" (click)="goToWishlist()">
              <i class="fas fa-heart"></i>
              <span>Wishlist</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div *ngIf="isLoading" class="loading-overlay">
  <div class="spinner-border text-warning" role="status">
    <span class="visually-hidden">Loading...</span>
  </div>
</div>
